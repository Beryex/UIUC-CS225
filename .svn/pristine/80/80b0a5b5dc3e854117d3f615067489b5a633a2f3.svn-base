#include <math.h>

#include "Image.h"

namespace cs225{
    // lighten an Image by increasing the luminance of every pixel by 0.1
    void Image::lighten(){
        for(unsigned x = 0; x < this->width(); x++){
            for(unsigned y = 0; y < this->height(); y++){
                HSLAPixel* Cur_Pixel = getPixel(x, y);
                Cur_Pixel->l += 0.1;
                if (Cur_Pixel->l > 1){
                    Cur_Pixel->l = 1;
                }
            }
        }
    }

    // lighten an Image by increasing the luminance of every pixel by amount
    void Image::lighten(double amount){
        for(unsigned x = 0; x < this->width(); x++){
            for(unsigned y = 0; y < this->height(); y++){
                HSLAPixel* Cur_Pixel = getPixel(x, y);
                Cur_Pixel->l += amount;
                if (Cur_Pixel->l > 1){
                    Cur_Pixel->l = 1;
                }
            }
        }
    }

    // Darken an Image by decreasing the luminance of every pixel by 0.1
    void Image::darken(){
        for(unsigned x = 0; x < this->width(); x++){
            for(unsigned y = 0; y < this->height(); y++){
                HSLAPixel* Cur_Pixel = getPixel(x, y);
                Cur_Pixel->l -= 0.1;
                if (Cur_Pixel->l < 0){
                    Cur_Pixel->l = 0;
                }
            }
        }
    }

    // darken an Image by decreasing the luminance of every pixel by amount
    void Image::darken(double amount){
        for(unsigned x = 0; x < this->width(); x++){
            for(unsigned y = 0; y < this->height(); y++){
                HSLAPixel* Cur_Pixel = getPixel(x, y);
                Cur_Pixel->l -= amount;
                if (Cur_Pixel->l < 0){
                    Cur_Pixel->l = 0;
                }
            }
        }
    }

    // Saturates an Image by increasing the saturation of every pixel by 0.1
    void Image::saturate(){
        for(unsigned x = 0; x < this->width(); x++){
            for(unsigned y = 0; y < this->height(); y++){
                HSLAPixel* Cur_Pixel = getPixel(x, y);
                Cur_Pixel->s += 0.1;
                if (Cur_Pixel->s > 1){
                    Cur_Pixel->s = 1;
                }
            }
        }
    }

    // Saturates an Image by increasing the saturation of every pixel by amount
    void Image::saturate(double amount){
        for(unsigned x = 0; x < this->width(); x++){
            for(unsigned y = 0; y < this->height(); y++){
                HSLAPixel* Cur_Pixel = getPixel(x, y);
                Cur_Pixel->s += amount;
                if (Cur_Pixel->s > 1){
                    Cur_Pixel->s = 1;
                }
            }
        }
    }

    // Desaturates an Image by decreasing the saturation of every pixel by 0.1
    void Image::desaturate(){
        for(unsigned x = 0; x < this->width(); x++){
            for(unsigned y = 0; y < this->height(); y++){
                HSLAPixel* Cur_Pixel = getPixel(x, y);
                Cur_Pixel->s -= 0.1;
                if (Cur_Pixel->s < 0){
                    Cur_Pixel->s = 0;
                }
            }
        }
    }

    // Desaturates an Image by decreasing the saturation of every pixel by amount
    void Image::desaturate(double amount){
        for(unsigned x = 0; x < this->width(); x++){
            for(unsigned y = 0; y < this->height(); y++){
                HSLAPixel* Cur_Pixel = getPixel(x, y);
                Cur_Pixel->s -= amount;
                if (Cur_Pixel->s < 0){
                    Cur_Pixel->s = 0;
                }
            }
        }
    }

    // Turns the image grayscale
    void Image::grayscale(){
        for(unsigned x = 0; x < this->width(); x++){
            for(unsigned y = 0; y < this->height(); y++){
                HSLAPixel* Cur_Pixel = getPixel(x, y);
                Cur_Pixel->s = 0;
            }
        }
    }

    // Rotates the color wheel by degrees
    void Image::rotateColor(double degrees){
        for(unsigned x = 0; x < this->width(); x++){
            for(unsigned y = 0; y < this->height(); y++){
                HSLAPixel* Cur_Pixel = getPixel(x, y);
                Cur_Pixel->h += degrees;
                if (Cur_Pixel->h > 360){
                    while (Cur_Pixel->h > 360){
                        Cur_Pixel->h -= 360;
                    }
                } else if (Cur_Pixel->h < 0){
                    while (Cur_Pixel->h < 0){
                        Cur_Pixel->h += 360;
                    }
                }
            }
        }
    }

    // Illinify the image
    void Image::illinify(){
        for(unsigned x = 0; x < this->width(); x++){
            for(unsigned y = 0; y < this->height(); y++){
                HSLAPixel* Cur_Pixel = getPixel(x, y);
                if (Cur_Pixel->h <= 113 || Cur_Pixel->h >= 294){
                    Cur_Pixel->h = 11.0;
                } else {
                    Cur_Pixel->h = 216.0;
                }
            }
        }
    }

    // Scale the Image by a given factor
    void Image::scale(double factor){
        unsigned tar_width = (int32_t)(this->width() * factor);
        unsigned tar_height = (int32_t)(this->height() * factor);
        this->resize( tar_width, tar_height);
        /*if (factor < 1){
            unsigned de_width = this->width() - tar_width;
            unsigned de_height = this->height() - tar_height;
            double width_interval = (tar_width / de_width);
            double height_interval = (tar_height / de_height);
            for(unsigned i = 0; i < de_width; i++){
                unsigned de_index = (unsigned)(round)(i * width_interval);
                for(unsigned j = de_index; j < this->width(); j++){
                    
                }
            }
            this->resize( tar_width, tar_height);
        } else if (factor > 1){
            unsigned in_width = tar_width - this->width();
            unsigned in_height = tar_height - this->height();
            this->resize( tar_width, tar_height);
        }*/
    }

    // Scales the image to fit within the size (w * h)
    void Image::scale( unsigned w, unsigned h){
        this->resize( w, h);
    }
}